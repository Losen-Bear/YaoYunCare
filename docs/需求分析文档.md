# “膳韵仙子”小程序项目 需求分析文档（MVP｜大赛演示版）

版本：v1.1  
状态：稳定版（面向大赛演示）  
依据：《概要设计1.0.md》虚拟人物预制素材方案

## 1. 项目概述
- 目标：以最低复杂度完成“体质判定 → 膳食推荐 → 播放预制虚拟人物制作素材”的闭环演示
- 范围：症状采集与体质判定（规则引擎）、食谱推荐与详情展示、预制素材播放、基础健康检查
- 不在范围：登录与鉴权、会员与支付、运营 CMS、埋点与数据看板、云上部署
- 声明：项目仅提供科普与饮食指导建议，不涉及医疗诊疗

## 2. 术语与缩写
- 体质：中医体质分类（如阳虚、阴虚、气虚、平和等）
- 预制素材：提前录制并与食谱绑定的视频讲解素材（video_url）
- 食谱：含食材、步骤的菜谱，按体质归类

## 3. 用户与角色
- 现场观众/评委：希望快速看到闭环演示与素材播放效果
- 普通用户：希望获得简单可执行的饮食建议（演示版不涉及登录）
- 项目成员（素材维护）：录制、上传并维护食谱对应的预制素材链接

## 4. 业务流程
1) 症状选择与提交  
2) 服务端规则判定主体质  
3) 根据体质拉取食谱列表（含素材链接）  
4) 前端使用原生 video 播放对应素材  
5) 健康提示与兜底（网络不佳或数据缺失时）

## 5. 用例列表
- UC-001 症状提交：用户选择症状并提交到服务端
- UC-002 体质判定：服务端依据规则返回 mainConstitution 与匹配详情
- UC-003 食谱查询：按体质返回食谱列表（ingredients/steps/video_url）
- UC-004 素材播放：前端直接播放 video_url（外链或本地路径）
- UC-005 健康检查：前端检测服务端可用性（/api/health/check）

## 6. 功能需求（FR）
- FR-01 症状采集与提交（前端表单）
- FR-02 体质判定规则（数据库 symptom_rule 或本地 JSON）
- FR-03 食谱查询与素材绑定（recipe.video_url）
- FR-04 素材播放（原生 video 组件）
- FR-05 健康检查接口与基础错误处理
- FR-06 数据初始化 SQL（体质、规则、食谱示例）

## 7. 非功能需求（NFR）
- 性能：本地演示下响应流畅（p95 ≤ 300ms）
- 可用性：现场网络允许第三方外链播放；提供本地视频兜底方案
- 安全：仅演示环境，无登录与鉴权；不采集敏感数据
- 兼容性：微信小程序最新版本；视频格式以 MP4/外链播放器为主
- 可维护性：数据结构与接口简洁清晰，便于扩展与讲解

## 8. 数据需求与字典（简化）
- constitution：体质名称
- symptom_rule：体质 → 症状列表（JSON 字符串）
- recipe：食谱（name、constitution、ingredients、steps、video_url）

## 9. 外部依赖与接口
- 第三方视频平台（B站/抖音）：托管预制素材并提供播放链接
- 本地视频：可将素材放入小程序目录并以相对路径播放
- MySQL：本地数据库，存储体质、规则与食谱数据

## 10. 约束与假设
- 无登录与鉴权；CORS 放开以支持小程序本地调试
- 外链方案需确保现场网络可用；本地方案需提前把视频放入目录
- 所有推荐与判定基于可解释的规则与数据

## 11. 验收与度量（演示版）
- 验收项：完整跑通闭环、素材播放稳定、接口返回符合规范
- 度量项：接口成功率 ≥ 99%、视频播放成功率 ≥ 95%（演示时）

## 12. 风险与应对
- 外链不可达：切换到本地视频路径；提前在现场网络做连通性检查
- 数据缺失或格式错误：接口返回兜底提示；使用示例数据初始化
- 设备兼容性：统一使用 MP4 或平台播放器链接，避免不兼容格式

## 13. 里程碑
- M1：完成体质判定、食谱查询与素材播放的闭环（当前版本）
