# 项目架构（简化版｜本地演示）

版本：v1.1  
目标：以最小工程复杂度支持大赛演示闭环，快速本地搭建与调试  
依据：《概要设计1.0.md》虚拟人物预制素材方案

## 1. 目录与文件建议
- miniprogram/：微信小程序源码（pages、components、utils）
- server/（或 backend-node/）：Node.js Koa2 服务端
  - app.js（入口与中间件）
  - routes/index.js（路由）
  - controller/（constitutionController、recipeController）
  - service/（constitutionService、recipeService）
  - config/db.js（MySQL 连接）
- docs/：需求、概要、详细、接口与架构文档

说明：目录命名可按现有仓库实际情况调整，重点是上述模块边界清晰。

## 2. 技术栈与依赖
- 服务端：Koa2、koa-router、koa-bodyparser、koa2-cors、mysql2（原生 SQL）
- 前端：微信小程序原生组件；使用 video 组件播放预制素材
- 数据库：本地 MySQL（≥5.7）
- 素材：B站/抖音外链或本地视频

## 3. 工程与提交规范（简化）
- 代码风格：统一使用 Prettier（可选）；保持一致的命名与数据结构
- 提交信息：遵循 Conventional Commits（feat/fix/docs/chore）
- 版本：采用简洁的语义化（例如 v1.1）；接口路径统一使用 /api 前缀

## 4. 运行与调试
- 环境要求：Node.js ≥ 14、MySQL ≥ 5.7、微信开发者工具
- 启动步骤：
  1) 创建数据库 constitution_recipe 并执行建表与示例数据  
  2) server 目录执行 npm install  
  3) node app.js 启动（默认端口 3000）  
  4) 小程序“本地设置”勾选“不校验合法域名”，请求指向 http://局域网IP:3000

## 5. 安全与配置（演示版）
- 无登录与鉴权；不采集敏感数据
- CORS 放开至 * 以支持本地调试
- 禁止在仓库中提交任何真实密码或密钥（db.js 密码本地修改）

## 6. 部署与发布（简化）
- 演示环境仅需本地运行，无需云资源与 CI/CD
- 如需打包：可将 server 目录打压缩包并在现场机器解压运行

## 7. 测试策略（轻量）
- 手动验证：跑通体质判定、食谱查询与素材播放三条主链路
- 接口自测：使用微信开发者工具或简单脚本访问 /api/* 接口

## 8. 里程碑与交付物
- M1（当前）：闭环演示完成，素材播放稳定，文档一致且可讲解

本架构说明聚焦最小可用演示与易维护性，去除支付、RBAC、监控与云部署等复杂度，保持与《概要设计1.0.md》一致。
